<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeoRide - Your Safe Ride</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }
          
    * {
      box-sizing: border-box;
      font-family: 'Segoe UI', sans-serif;
    }
    body {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
    }
    .container {
      background: white;
      padding: 2rem;
      border-radius: 12px;
      width: 100%;
      max-width: 600px;
      width: 400px;
      box-shadow: 0 8px 150px rgba(0,0,0,0.15);
      border: 1px solid #ccc;
      font-weight: 500;
}

    
    h2 {
      text-align: center;
      margin-bottom: 1rem;
    }
    .form-group {
      margin-bottom: 1rem;
      position: relative;
    }
    label {
      display: block;
      margin-bottom: 5px;
    }
    input[type="email"],
    input[type="password"],
    input[type="text"] {
      width: 100%;
      padding: 10px;
      padding-right: 40px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    .toggle-password {
      position: absolute;
      right: 10px;
      top: 38px;
      cursor: pointer;
      color: #555;
    }
    .inline-feedback {
      font-size: 0.85rem;
      color: red;
      margin-top: 5px;
    }
    .checkbox-group {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.9rem;
      margin-bottom: 1rem;
    }
    .forgot-password {
      display: block;
      text-align: center;
      margin-top: 2rem;
      margin-bottom: 1rem;
      font-size: 0.9rem;
      color: black;
      text-decoration: none;
    }
    .signup-page{ 
      display: block;
      text-align: center;
      margin: 1rem 0;
      font-size: 0.9rem;
      color: black;
      text-decoration: none;

    }
    .btn {
      width: 100%;
      padding: 10px;
      border: none;
      border-radius: 6px;
      
      color: white;
       background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      font-weight: bold;
      cursor: pointer;
    }
    .btn:disabled {
      background-color: #999;
    }
    .spinner {
      display: none;
      width: 24px;
      height: 24px;
      margin: 0 auto;
      border: 3px solid #f3f3f3;
      border-top: 3px solid black;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-top: 1rem;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    .social-buttons {
      display: flex;
      gap: 10px;
      margin-top: 1rem;
    }
    .social-btn {
      flex: 1;
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #ccc;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      cursor: pointer;
      font-size: 0.85rem;
    }
     .logo {
            text-align: center;
            margin-bottom: 20px;
        }

        .logo i {
            font-size: 3em;
            color: #667eea;
            animation: rotate 2s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        

        #mainInterface {
            display: none;
            width: 95%;
            max-width: 1200px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            animation: fadeInUp 0.6s ease-out;
           
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            text-align: center;
            font-size: 1.5em;
            font-weight: 600;
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .main-content {
            padding: 30px;
        }

        .status-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            text-align: center;
            position: relative;
            overflow: hidden;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .status-card h3 {
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .status-indicator {
            font-size: 2em;
            margin: 10px 0;
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .interactive-map {
            background: #f8f9fa;
            border: 3px dashed #e9ecef;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            margin-bottom: 25px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .interactive-map:hover {
            background: #e9ecef;
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .interactive-map i {
            font-size: 4em;
            color: #667eea;
            margin-bottom: 15px;
            animation: mapPulse 2s infinite;
        }

        @keyframes mapPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .ride-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .ride-card {
            background: white;
            border: 2px solid #f0f0f0;
            border-radius: 15px;
            padding: 25px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .ride-card:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.1);
        }

        .ride-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .emergency-section {
            background: #fff5f5;
            border: 2px solid #fed7d7;
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
            text-align: center;
            display: none;
        }

        .panic-button {
            background: linear-gradient(135deg, #ff6b6b 0%, #ff5722 100%);
            color: white;
            border: none;
            padding: 20px 40px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.2em;
            font-weight: 600;
            margin: 20px 0;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
        }

        .panic-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(255, 107, 107, 0.4);
        }

        .panic-button:active {
            animation: shake 0.5s;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .emergency-contacts {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border: 2px solid #e9ecef;
            display: none;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                max-height: 0;
                padding: 0 25px;
            }
            to {
                opacity: 1;
                max-height: 500px;
                padding: 25px;
            }
        }

        .contact-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            background: #f8f9fa;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .contact-item:hover {
            background: #667eea;
            color: white;
            transform: translateX(10px);
            border-color: #5a67d8;
        }

        .contact-item.selected {
            background: #48bb78;
            color: white;
            border-color: #38a169;
        }

        .floating-widgets {
            position: fixed;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 15px;
            z-index: 100;
        }

        .floating-widget {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .floating-widget:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #48bb78;
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(72, 187, 120, 0.3);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 200;
        }

        .notification.show {
            transform: translateX(0);
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 300;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            animation: zoomIn 0.3s ease;
        }

        @keyframes zoomIn {
            from {
                opacity: 0;
                transform: scale(0.7);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .modal-button {
            padding: 12px 30px;
            margin: 10px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .confirm-btn {
            background: #ff6b6b;
            color: white;
        }

        .cancel-btn {
            background: #e2e8f0;
            color: #4a5568;
        }

        .modal-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        footer {
            text-align: center;
            padding: 20px;
            color: #666;
            background: #f8f9fa;
            border-radius: 0 0 20px 20px;
        }

        .booking-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        .booking-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .booking-form input, .booking-form select {
            padding: 12px 15px;
            border: 2px solid #e1e1e1;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .booking-form input:focus, .booking-form select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .book-btn {
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .book-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .ride-status {
            display: none;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Location suggestion specific styles */
        .autocomplete-container {
            position: relative;
        }

        .autocomplete-items {
            position: absolute;
            border: 1px solid #d4d4d4;
            border-bottom: none;
            border-top: none;
            z-index: 99;
            top: 100%;
            left: 0;
            right: 0;
            max-height: 200px;
            overflow-y: auto;
            background-color: #f8f9fa;
            border-radius: 10px;
        }

        .autocomplete-items div {
            padding: 10px;
            cursor: pointer;
            background-color: #fff;
            border-bottom: 1px solid #d4d4d4;
        }

        .autocomplete-items div:hover {
            background-color: #e9e9e9;
        }

        .autocomplete-active {
            background-color: #667eea !important;
            color: #ffffff;
        }


        @media (max-width: 768px) {
            .ride-info-grid {
                grid-template-columns: 1fr;
            }
            
            .floating-widgets {
                position: relative;
                right: auto;
                top: auto;
                transform: none;
                flex-direction: row;
                justify-content: center;
                margin: 20px 0;
            }
        }
    </style>
</head>
<body>
    <div class="login-container" id="loginContainer">
      <div class="container">
    
  
        <div class="logo">
            <i class="fas fa-car-side"></i>
        </div>
        <h2>NeoRide</h2>
   <form id="Login-form">
      <div class="form-group">
        <label>Email</label>
        <input type="email" id="email" required />
        <div id="emailFeedback" class="inline-feedback"></div>
      </div>

      <div class="form-group">
        <label>Password</label>
        <input type="password" id="password" required />
        <span class="toggle-password" onclick="togglePassword('password')">üëÅÔ∏è</span>
      </div>

      <div class="checkbox-group">
        <input type="checkbox" id="remember" />
        <label for="remember">Remember Me</label>
      </div>

      <a href="#" class="forgot-password">Forgot Password?</a>

      <button type="submit" class="btn">Login</button>
      <div class="spinner" id="spinner"></div>

      <div class="signup-page">
      <p>Don't have an account? <a href="signup.html"> Sign up</a></p>
      </div>

      <div class="social-buttons">
        <div class="social-btn"><img src="images/instagram.png" height="18px"> Instagram</div>
        <div class="social-btn"><img src="images/twitter.png" height="18px"> Twitter</div>
      </div>
    </form>
  </div>

  </div>

<div id="mainInterface">
        <header>
            <i class="fas fa-car-side"></i> NeoRide - Your Safe Journey
        </header>
        
        <div class="main-content">
            <div class="booking-section" id="bookingSection">
                <h2><i class="fas fa-map-marker-alt"></i> Book Your Ride</h2>
                <div class="booking-form">
                    <div class="autocomplete-container">
                        <input type="text" id="pickupLocation" placeholder="Enter pickup location" required>
                    </div>
                    <div class="autocomplete-container">
                        <input type="text" id="dropoffLocation" placeholder="Enter dropoff location" required>
                    </div>
                    <select id="rideType">
                        <option value="standard">Standard</option>
                        <option value="premium">Premium</option>
                        <option value="xl">XL</option>
                    </select>
                    <button class="book-btn" onclick="bookRide()">
                        <span id="bookText">Book Ride</span>
                        <div id="bookLoader" class="loading" style="display: none;"></div>
                    </button>
                </div>
            </div>

            <div class="ride-status" id="rideStatus">
                <div class="status-card">
                    <h3><i class="fas fa-shield-alt"></i> Ride Status</h3>
                    <div class="status-indicator">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <p>Your journey is being monitored safely</p>
                </div>

                <div class="interactive-map" onclick="toggleMap()">
                    <i class="fas fa-map-marked-alt"></i>
                    <h3>Live Location Tracking</h3>
                    <p>Click to expand map view</p>
                    <div id="mapContainer" style="display: none; margin-top: 20px;">
                        <iframe id="liveMapFrame" src="https://www.google.com/maps/embed/v1/place?key=YOUR_Maps_API_KEY&q=BITS+Pilani+Hyderabad+Campus" width="100%" height="300" style="border:0; border-radius: 10px;" allowfullscreen="" loading="lazy"></iframe>
                    </div>
                </div>

                <div class="ride-info-grid">
                    <div class="ride-card">
                        <h3><i class="fas fa-user-circle"></i> Driver Information</h3>
                        <p><strong>Name:</strong> Alex Rider</p>
                        <p><strong>Rating:</strong> ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (4.9)</p>
                        <p><strong>Vehicle:</strong> Tesla Model 3 - Black</p>
                        <p><strong>License:</strong> XYZ-7890</p>
                        <p><strong>Phone:</strong> +91 9306953755</p>
                    </div>
                    <div class="ride-card">
                        <h3><i class="fas fa-route"></i> Trip Details</h3>
                        <p><strong>From:</strong> <span id="displayPickup">BITS Pilani Gate 1</span></p>
                        <p><strong>To:</strong> <span id="displayDropoff">Vidya Vihar Colony</span></p>
                        <p><strong>Distance:</strong> 2.5 km</p>
                        <p><strong>ETA:</strong> <span id="eta">10 mins</span></p>
                    </div>
                </div>

                <div class="emergency-section" id="emergencySection">
                    <h2><i class="fas fa-exclamation-triangle"></i> Emergency Center</h2>
                    <p>Press the SOS button if you feel unsafe</p>
                    
                    <button class="panic-button" onclick="showEmergencyContacts()">
                        <i class="fas fa-exclamation-triangle"></i> SOS - EMERGENCY
                    </button>

                    <div class="emergency-contacts" id="emergencyContactList">
                        <h3><i class="fas fa-phone"></i> Emergency Contacts</h3>
                        <div class="contact-item" onclick="selectContact('Nikhil (Bro)', '6376589226', this)">
                            <span><i class="fas fa-user"></i> Nikhil (Bro)</span>
                            <span>6376589226</span>
                        </div>
                        <div class="contact-item" onclick="selectContact('Riya (Sis)', '9729349281', this)">
                            <span><i class="fas fa-user"></i> Riya (Sis)</span>
                            <span>9729349281</span>
                        </div>
                        <div class="contact-item" onclick="selectContact('Papa', '9350721808', this)">
                            <span><i class="fas fa-user"></i> Papa</span>
                            <span>9350721808</span>
                        </div>
                        <div class="contact-item" onclick="selectContact('Mom', '9865231788', this)">
                            <span><i class="fas fa-user"></i> Mom</span>
                            <span>4449876543</span>
                        </div>
                        <div class="contact-item" onclick="selectContact('Police', '100', this)">
                            <span><i class="fas fa-shield-alt"></i> Police</span>
                            <span>100</span>
                        </div>
                        <div class="contact-item" onclick="selectContact('Women Safety', '181', this)">
                            <span><i class="fas fa-shield-alt"></i> Women Safety</span>
                            <span>181</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="floating-widgets">
            <button class="floating-widget" onclick="shareLocation()" title="Share Location">
                <i class="fas fa-location-arrow"></i>
            </button>
            <button class="floating-widget" onclick="callDriver()" title="Call Driver">
                <i class="fas fa-phone"></i>
            </button>
            <button class="floating-widget" onclick="sendFeedback()" title="Send Feedback">
                <i class="fas fa-comment"></i>
            </button>
        </div>

        <footer>
            ¬© 2025 NeoRide - Your Safety First
        </footer>
    </div>

    <div id="notification" class="notification">
        <span id="notificationText"></span>
    </div>

    <div id="emergencyModal" class="modal">
        <div class="modal-content">
            <h2><i class="fas fa-exclamation-triangle" style="color: #ff6b6b;"></i> Confirm Emergency Alert</h2>
            <p>Are you sure you want to send an SOS alert?</p>
            <p><strong>Selected Contact:</strong> <span id="selectedContactName"></span></p>
            <button class="modal-button confirm-btn" onclick="confirmSOS()">Send SOS</button>
            <button class="modal-button cancel-btn" onclick="closeModal()">Cancel</button>
        </div>
    </div>

    <script>
    function togglePassword(id) {
    const input = document.getElementById(id);
    input.type = input.type === "password" ? "text" : "password";
     }

  const form = document.getElementById("Login-form");
  const email = document.getElementById("email");
  const password = document.getElementById("password");
  const emailFeedback = document.getElementById("emailFeedback");
  const spinner = document.getElementById("spinner");

  // Validate email format live
  email.addEventListener("input", () => {
    const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    emailFeedback.textContent = regex.test(email.value)
      ? ""
      : "Enter a valid email address";
  });

  // Login form submit
  form.addEventListener("submit", function (e) {
    e.preventDefault();

    spinner.style.display = "block";

    setTimeout(() => {
      spinner.style.display = "none";

      // Get stored credentials from localStorage
      const storedEmail = localStorage.getItem("email");
      const storedPassword = localStorage.getItem("password");
      if (
        email.value === storedEmail &&
        password.value === storedPassword
      ) {
       document.getElementById('loginContainer').style.display = 'none';
                    document.getElementById('mainInterface').style.display = 'block';
                    showNotification('Welcome back ! Ready to book your ride.', 'success');
                    loginText.style.display = 'inline';
                    loginLoader.style.display = 'none';
                } else {
                    showNotification('Invalid credentials. Please try again.', 'error');
                    loginText.style.display = 'inline';
                    loginLoader.style.display = 'none';
                }

      form.reset();
    }, 1000);
  });
 

       let selectedContact = null;
        let etaTimer;
        let mapUpdateInterval; // For live map updates
        const driverInfo = {
            name: "Alex Rider",
            phone: "+91 9306953755",
            vehicle: "Tesla Model 3 - Black",
            license: "XYZ-7890"
        };
        
        // Placeholder for user's current location (Gangapur, Rajasthan, India)
        const userCurrentLocation = { lat: 25.6888, lng: 76.3245 }; // Approximate coordinates for Gangapur, Rajasthan

        // Function to simulate location suggestions (replace with actual API call)
        async function getLocationSuggestions(query) {
            if (query.length < 3) return []; // Don't suggest for very short queries

            // In a real application, you would use a geocoding API here, e.g., Google Places API, OpenStreetMap Nominatim
            // Example:
            // const response = await fetch(`https://maps.googleapis.com/maps/api/place/autocomplete/json?input=${query}&key=YOUR_GOOGLE_PLACES_API_KEY`);
            // const data = await response.json();
            // return data.predictions.map(prediction => prediction.description);

            // For demonstration, use a static list
            const suggestions = [
                "BITS Pilani Gate 1",
                "BITS Pilani, Rajasthan",
                "Vidya Vihar Colony",
                "Gangapur City Railway Station",
                "New Delhi Railway Station",
                "Indira Gandhi International Airport",
                "Jaipur International Airport",
                "Hotel Grand Imperial",
                "City Hospital",
                "Central Park"
            ];
            return suggestions.filter(s => s.toLowerCase().includes(query.toLowerCase()));
        }

        function autocomplete(inp, callback) {
            let currentFocus;

            inp.addEventListener("input", async function(e) {
                let a, b, i, val = this.value;
                closeAllLists();
                if (!val) { return false; }
                currentFocus = -1;

                a = document.createElement("DIV");
                a.setAttribute("id", this.id + "autocomplete-list");
                a.setAttribute("class", "autocomplete-items");
                this.parentNode.appendChild(a);

                const suggestions = await callback(val);

                for (i = 0; i < suggestions.length; i++) {
                    b = document.createElement("DIV");
                    b.innerHTML = "<strong>" + suggestions[i].substr(0, val.length) + "</strong>";
                    b.innerHTML += suggestions[i].substr(val.length);
                    b.innerHTML += "<input type='hidden' value='" + suggestions[i] + "'>";
                    b.addEventListener("click", function(e) {
                        inp.value = this.getElementsByTagName("input")[0].value;
                        closeAllLists();
                    });
                    a.appendChild(b);
                }
            });

            inp.addEventListener("keydown", function(e) {
                let x = document.getElementById(this.id + "autocomplete-list");
                if (x) x = x.getElementsByTagName("div");
                if (e.keyCode == 40) { // Arrow Down
                    currentFocus++;
                    addActive(x);
                } else if (e.keyCode == 38) { // Arrow Up
                    currentFocus--;
                    addActive(x);
                } else if (e.keyCode == 13) { // Enter
                    e.preventDefault();
                    if (currentFocus > -1) {
                        if (x) x[currentFocus].click();
                    }
                }
            });

            function addActive(x) {
                if (!x) return false;
                removeActive(x);
                if (currentFocus >= x.length) currentFocus = 0;
                if (currentFocus < 0) currentFocus = (x.length - 1);
                x[currentFocus].classList.add("autocomplete-active");
            }

            function removeActive(x) {
                for (let i = 0; i < x.length; i++) {
                    x[i].classList.remove("autocomplete-active");
                }
            }

            function closeAllLists(elmnt) {
                const x = document.getElementsByClassName("autocomplete-items");
                for (let i = 0; i < x.length; i++) {
                    if (elmnt != x[i] && elmnt != inp) {
                        x[i].parentNode.removeChild(x[i]);
                    }
                }
            }

            document.addEventListener("click", function (e) {
                closeAllLists(e.target);
            });
        }

        // Initialize autocomplete for pickup and dropoff
        autocomplete(document.getElementById("pickupLocation"), getLocationSuggestions);
        autocomplete(document.getElementById("dropoffLocation"), getLocationSuggestions);

        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const loginText = document.getElementById('loginText');
            const loginLoader = document.getElementById('loginLoader');

            loginText.style.display = 'none';
            loginLoader.style.display = 'inline-block';

            setTimeout(() => {
                if (username === "abcd" && password === "123456") {
                    document.getElementById('loginContainer').style.display = 'none';
                    document.getElementById('mainInterface').style.display = 'block';
                    showNotification('Welcome back, abcd! Ready to book your ride.', 'success');
                    loginText.style.display = 'inline';
                    loginLoader.style.display = 'none';
                } else {
                    showNotification('Invalid credentials. Please try again.', 'error');
                    loginText.style.display = 'inline';
                    loginLoader.style.display = 'none';
                }
            }, 1500);
        }

        function bookRide() {
            const pickup = document.getElementById('pickupLocation').value;
            const dropoff = document.getElementById('dropoffLocation').value;
            const rideType = document.getElementById('rideType').value;
            const bookText = document.getElementById('bookText');
            const bookLoader = document.getElementById('bookLoader');

            if (!pickup || !dropoff) {
                showNotification('Please enter both pickup and dropoff locations', 'error');
                return;
            }

            bookText.style.display = 'none';
            bookLoader.style.display = 'inline-block';

            setTimeout(() => {
                document.getElementById('bookingSection').style.display = 'none';
                document.getElementById('rideStatus').style.display = 'block';
                document.getElementById('emergencySection').style.display = 'block';
                
                document.getElementById('displayPickup').textContent = pickup;
                document.getElementById('displayDropoff').textContent = dropoff;
                
                // Update map iframe source with dynamic locations
                updateMap(pickup, dropoff);

                showNotification(`Your ${rideType} ride has been booked!`, 'success');
                startETACountdown();
                
                bookText.style.display = 'inline';
                bookLoader.style.display = 'none';
            }, 2000);
        }

        function toggleMap() {
            const mapContainer = document.getElementById('mapContainer');
            if (mapContainer.style.display === 'none') {
                mapContainer.style.display = 'block';
                showNotification('Map expanded successfully', 'success');
                // Start continuous map updates when expanded
                startLiveMapUpdates();
            } else {
                mapContainer.style.display = 'none';
                // Stop continuous map updates when collapsed
                clearInterval(mapUpdateInterval);
            }
        }

        function updateMap(pickup, dropoff) {
            const mapFrame = document.getElementById('liveMapFrame');
            // This is a placeholder. In a real app, you'd get precise coordinates
            // and use a Directions API to show the route and update driver's position.
            // For now, we'll just center the map based on the dropoff for visual effect.
            const query = encodeURIComponent(`${pickup} to ${dropoff}`);
            mapFrame.src = `https://www.google.com/maps/embed/v1/directions?key=YOUR_Maps_API_KEY&origin=${encodeURIComponent(pickup)}&destination=${encodeURIComponent(dropoff)}&mode=driving`;
            // Replace 'YOUR_Maps_API_KEY' with your actual Google Maps API Key
        }

        // Simulates live location updates for the map
        function startLiveMapUpdates() {
            let currentLat = userCurrentLocation.lat;
            let currentLng = userCurrentLocation.lng;
            const mapFrame = document.getElementById('liveMapFrame');

            // This is a very basic simulation. A real implementation would involve:
            // 1. Getting actual driver location from a backend service.
            // 2. Using a mapping library (e.g., Google Maps JavaScript API) to
            //    dynamically update a marker on the map.
            mapUpdateInterval = setInterval(() => {
                // Simulate driver moving towards destination
                // For demo, slightly change coordinates
                currentLat += (Math.random() - 0.5) * 0.0005; 
                currentLng += (Math.random() - 0.5) * 0.0005;

                // Update the map iframe source to show a new 'place' (driver's simulated location)
                // In a real app, you'd update a marker on a dynamic map, not reload the iframe.
                // This reload is just for visual demonstration of "update".
                mapFrame.src = `https://www.google.com/maps/embed/v1/place?key=YOUR_Maps_API_KEY&q=${currentLat},${currentLng}`;
                // Replace 'YOUR_Maps_API_KEY' with your actual Google Maps API Key
            }, 5000); // Update map every 5 seconds
        }


        function showEmergencyContacts() {
            const contactList = document.getElementById('emergencyContactList');
            if (contactList.style.display === 'none' || !contactList.style.display) {
                contactList.style.display = 'block';
                showNotification('Emergency contacts displayed', 'info');
            } else {
                contactList.style.display = 'none';
            }
        }

        function selectContact(name, phone, element) {
            document.querySelectorAll('.contact-item').forEach(item => {
                item.classList.remove('selected');
            });
            
            element.classList.add('selected');
            
            selectedContact = { name, phone };
            document.getElementById('selectedContactName').textContent = `${name} (${phone})`;
            
            document.getElementById('emergencyModal').style.display = 'flex';
        }

        function confirmSOS() {
            if (selectedContact) {
                sendSOSMessage(selectedContact.phone);
                showNotification(`SOS sent to ${selectedContact.name}`, 'success');
                closeModal();
            }
        }

        function closeModal() {
            document.getElementById('emergencyModal').style.display = 'none';
        }

        function sendSOSMessage(phoneNumber) {
            // Use Geolocation API to get current precise location
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition((position) => {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    const googleMapsLink = `https://www.google.com/maps?q=${lat},${lng}`;
                    const message = `EMERGENCY! I need help with my NeoRide. My current location: ${googleMapsLink}. Driver: ${driverInfo.name}, Phone: ${driverInfo.phone}, Vehicle: ${driverInfo.vehicle}, License: ${driverInfo.license}`;
                    const url = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
                    window.open(url, '_blank');
                    
                    console.log("Emergency alert sent with live location:", {
                        timestamp: new Date(),
                        recipient: selectedContact,
                        driverDetails: driverInfo,
                        location: { lat, lng }
                    });
                }, (error) => {
                    console.error("Error getting location for SOS:", error);
                    // Fallback if location access is denied
                    const fallbackMessage = `EMERGENCY! I need help with my NeoRide. My current general location is Gangapur, Rajasthan, India. Driver: ${driverInfo.name}, Phone: ${driverInfo.phone}, Vehicle: ${driverInfo.vehicle}, License: ${driverInfo.license}`;
                    const url = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(fallbackMessage)}`;
                    window.open(url, '_blank');
                    showNotification('Could not get precise location, sending general emergency alert.', 'error');
                });
            } else {
                // Browser doesn't support Geolocation
                const fallbackMessage = `EMERGENCY! I need help with my NeoRide. My current general location is Gangapur, Rajasthan, India. Driver: ${driverInfo.name}, Phone: ${driverInfo.phone}, Vehicle: ${driverInfo.vehicle}, License: ${driverInfo.license}`;
                const url = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(fallbackMessage)}`;
                window.open(url, '_blank');
                showNotification('Geolocation not supported, sending general emergency alert.', 'error');
            }
        }

        function shareLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition((position) => {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    const googleMapsLink = `https://www.google.com/maps?q=${lat},${lng}`;
                    const message = `My current live location is: ${googleMapsLink}`;
                    
                    // Here, you would typically send this to selected emergency contacts
                    // For demo, we'll just show a notification and log it.
                    showNotification('Live location retrieved. Ready to share.', 'success');
                    console.log("Current Live Location:", { lat, lng, link: googleMapsLink });

                    // Simulate sharing with one of the emergency contacts (e.g., Nikhil)
                    const nikhilPhone = '6376589226';
                    const url = `https://wa.me/${nikhilPhone}?text=${encodeURIComponent(message)}`;
                    window.open(url, '_blank');
                    showNotification('Location shared with Nikhil (Bro)', 'success');

                }, (error) => {
                    console.error("Error getting location for sharing:", error);
                    showNotification('Could not get your live location.', 'error');
                });
            } else {
                showNotification('Geolocation is not supported by your browser.', 'error');
            }

            const widget = document.querySelector('.floating-widget');
            widget.style.animation = 'pulse 0.5s';
            setTimeout(() => widget.style.animation = '', 500);
        }

        function callDriver() {
            const driverPhone = driverInfo.phone.replace(/\s+/g, '');
            showNotification(`Calling driver: ${driverInfo.phone}...`, 'info');
            
            window.open(`tel:${driverPhone}`);
            
            setTimeout(() => {
                showNotification(`Call connected to ${driverInfo.name}`, 'success');
            }, 2000);
        }

        function sendFeedback() {
            const feedback = prompt('Please share your feedback:');
            if (feedback) {
                showNotification('Feedback sent successfully', 'success');
            }
        }

        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');
            
            notificationText.textContent = message;
            notification.className = 'notification show';
            
            if (type === 'success') {
                notification.style.background = '#48bb78';
            } else if (type === 'error') {
                notification.style.background = '#f56565';
            } else {
                notification.style.background = '#4299e1';
            }
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function startETACountdown() {
            let eta = 10;
            const etaElement = document.getElementById('eta');
            
            etaTimer = setInterval(() => {
                eta--;
                etaElement.textContent = `${eta} mins`;
                
                if (eta <= 0) {
                    clearInterval(etaTimer);
                    etaElement.textContent = 'Arrived!';
                    showNotification('You have reached your destination!', 'success');
                }
            }, 60000);
        }

        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && document.getElementById('loginContainer').style.display !== 'none') {
                login();
            }
        });

        window.onclick = function(event) {
            const modal = document.getElementById('emergencyModal');
            if (event.target === modal) {
                closeModal();
            }
        }

        setInterval(() => {
            const statusIndicator = document.querySelector('.status-indicator i');
            if (statusIndicator) {
                statusIndicator.style.animation = 'none';
                setTimeout(() => statusIndicator.style.animation = 'bounce 1s infinite', 10);
            }
        }, 10000);
    </script>
</body>
</html>
